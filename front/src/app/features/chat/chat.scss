.chat-container {
  display: flex;
  height: calc(100vh - 64px); // On déduit la hauteur de la navbar
  background: #f9fafb;
  overflow: hidden;

  // SIDEBAR
  .sidebar {
    width: 320px;
    background: white;
    border-right: 1px solid #e5e7eb;
    display: flex;
    flex-direction: column;

    .sidebar-header {
      padding: 1.5rem;
      border-bottom: 1px solid #f3f4f6;
      display: flex;
      flex-direction: column;
      gap: 1rem;

      .btn-back {
        align-self: flex-start;
        background: none; border: none; color: #6b7280;
        cursor: pointer; font-size: 0.9rem;
        &:hover { color: #2563eb; }
      }

      .btn-new {
        background: #2563eb; color: white; border: none;
        padding: 0.75rem; border-radius: 8px; font-weight: 600;
        cursor: pointer;
      }
      .sidebar-title { font-size: 1.1rem; color: #111827; }
    }

    .ticket-list {
      flex: 1;
      overflow-y: auto;
      padding: 1rem;

      .list-section {
        margin-bottom: 1.5rem;
        label { 
          font-size: 0.7rem; font-weight: 700; color: #9ca3af;
          letter-spacing: 0.05em; margin-left: 0.5rem;
        }
      }

      .ticket-item {
        margin-top: 0.5rem;
        padding: 1rem;
        border-radius: 12px;
        background: #f9fafb;
        cursor: pointer;
        font-size: 0.9rem;
        transition: all 0.2s;

        &:hover { background: #f3f4f6; }
        &.active { background: #eef2ff; border: 1px solid #2563eb; color: #2563eb; }
        &.active-unread { border-left: 4px solid #ef4444; background: #fff1f2; }
        &.archived { opacity: 0.6; }
      }
    }
  }

  // ZONE DE CHAT
  .chat-window {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: #ffffff;

    .chat-header {
      padding: 1rem 2rem;
      border-bottom: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      align-items: center;

      h3 { font-size: 1rem; margin: 0; }
      .status-badge { font-size: 0.75rem; color: #10b981; &::before { content: '● '; } }
      .btn-close-ticket {
        background: #fef2f2; color: #dc2626; border: 1px solid #fee2e2;
        padding: 0.5rem 1rem; border-radius: 6px; cursor: pointer;
        &:hover { background: #fee2e2; }
      }
    }

    .messages-container {
      flex: 1;
      padding: 2rem;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 1rem;

      .message {
        max-width: 70%;
        display: flex;
        flex-direction: column;
        
        .bubble { padding: 0.75rem 1rem; border-radius: 18px; font-size: 0.95rem; }
        .time { font-size: 0.7rem; color: #9ca3af; margin-top: 4px; }

        &.received {
          align-self: flex-start;
          .bubble { background: #f3f4f6; color: #1f2937; border-bottom-left-radius: 4px; }
        }

        &.sent {
          align-self: flex-end;
          .bubble { background: #2563eb; color: white; border-bottom-right-radius: 4px; }
          .time { text-align: right; }
        }
      }
    }

    .chat-input-area {
      padding: 1.5rem 2rem;
      border-top: 1px solid #e5e7eb;
      display: flex;
      gap: 1rem;

      input {
        flex: 1;
        padding: 0.75rem 1.25rem;
        border: 1px solid #e5e7eb;
        border-radius: 100px;
        outline: none;
        &:focus { border-color: #2563eb; }
      }

      .btn-send {
        background: #2563eb; color: white; border: none;
        width: 42px; height: 42px; border-radius: 50%;
        display: flex; align-items: center; justify-content: center;
        cursor: pointer;
        &:hover { background: #1d4ed8; }
      }
    }

    .empty-state {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: #9ca3af;
      .icon { font-size: 4rem; margin-bottom: 1rem; opacity: 0.3; }
    }
  }
}

.section-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 0.75rem 1rem;
  cursor: pointer;
  border-radius: 8px;
  transition: all 0.2s ease;

  &:hover {
    background: #f3f4f6;
    .icon-wrapper { color: #2563eb; }
  }

  label {
    font-size: 0.75rem;
    font-weight: 700;
    color: #6b7280;
    letter-spacing: 0.05em;
    cursor: pointer;
    user-select: none; // Pour éviter de sélectionner le texte en cliquant vite
  }

  .icon-wrapper {
    display: flex;
    align-items: center;
    color: #9ca3af;
    transition: transform 0.2s ease;
    
    svg {
      display: block; // Évite les décalages d'alignement
    }
  }
}

// Optionnel : si tu veux une micro-animation quand on clique
.list-section.collapsed {
  .section-header {
    background: transparent;
  }
}

.message {
  display: flex;
  flex-direction: column;
  margin-bottom: 1rem;
  max-width: 70%; // Limite la largeur des bulles

  .bubble { 
    padding: 0.75rem 1rem; 
    border-radius: 18px; 
    font-size: 0.95rem; 
    word-wrap: break-word;
  }
  
  .time { 
    font-size: 0.7rem; 
    color: #9ca3af; 
    margin-top: 4px; 
  }

  // Ce qui est "Envoyé" par l'utilisateur actuel (Droite + Bleu)
  &.sent {
    align-self: flex-end; // Aligne le bloc entier à droite
    align-items: flex-end; // Aligne le texte/time à droite
    
    .bubble {
      background: #2563eb; 
      color: white;
      border-bottom-right-radius: 4px;
    }
  }

  // Ce qui est "Reçu" par l'utilisateur actuel (Gauche + Gris)
  &.received {
    align-self: flex-start; // Aligne le bloc entier à gauche
    align-items: flex-start; // Aligne le texte/time à gauche
    
    .bubble {
      background: #f3f4f6; 
      color: #1f2937;
      border-bottom-left-radius: 4px;
    }
  }
}